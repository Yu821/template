ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm", se=TRUE)
ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm", se=FALSE)
ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm", se=FALSE)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(gapminder)
library(reshape2)
library(maps)
library(ggmap)
library(lubridate)
data <- read.csv(file = './fec_2008-2022.csv')
# Get rid of variable X from data
data <- data %>%
select(-X)
# Column with only numerical and int data type
num_data <- data %>%
select(where(is.numeric)) %>%
select(-c(Cand_Office_Dist, Cand_Zip))
# Convert party affiliation to number -1 to 1 to use later for visualization
data$Cand_State <- tolower(state.name[match(data$Cand_State, state.abb)])
data$Cand_Office_St <- tolower(state.name[match(data$Cand_Office_St, state.abb)])
# data$Cand_State <- tolower(state.name[match(data$Cand_State, state.abb)])
data$Cand_City <- tolower(data$Cand_City)
data <- data %>% mutate(
Cand_Party_Affiliation_num = case_when(Cand_Party_Affiliation=="DEM" ~ 1,
Cand_Party_Affiliation=="REP" ~ -1,
Cand_Party_Affiliation!="REP" | Cand_Party_Affiliation!="DEM" ~ 0))
# Check data
# summary(data)
str(data)
data$Coverage_End_Date <- as.Date(data$Coverage_End_Date, "%d/%m/%Y")
data$coverage_year <- format(data$Coverage_End_Date, format="%Y")
data$coverage_month_day <- format(data$Coverage_End_Date, format="%m/%d")
data <- data %>%
filter(coverage_year > 2008 & coverage_year < 2021)
# data$coverage_month_day
ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm", se=FALSE)
ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm", se=FALSE)
knitr::opts_chunk$set(echo = TRUE)
# Sort by Total_Receipt and get top 50 candidates
receipt_data = data[order(-data$Total_Receipt),]
receipt_data = receipt_data[0:40,]
ggplot(receipt_data, aes(x=reorder(Cand_Name,Total_Receipt), y=Total_Receipt/1000000)) +
geom_point() +
coord_flip() +
theme(text = element_text(size=11, color="black"), axis.text.y=element_text(colour="black"),
axis.title=element_text(size=12)) +
labs(x="Candidate Name", y="Total Receipt in million dollars")
# Get party_ratio on each states
party_ratio_states <- data %>%
group_by(Cand_Office_St) %>%
summarize(party_ratio = mean(Cand_Party_Affiliation_num)) %>%
select(c(Cand_Office_St, party_ratio))
head(party_ratio_states)
# Sort by Total_Receipt and get top 50 candidates
receipt_data = data[order(-data$Total_Receipt),]
receipt_data = receipt_data[0:40,]
ggplot(receipt_data, aes(x=reorder(Cand_Name,Total_Receipt), y=Total_Receipt/1000000)) +
geom_point() +
coord_flip() +
theme(text = element_text(size=11, color="black"), axis.text.y=element_text(colour="black"),
axis.title=element_text(size=12)) +
labs(x="Candidate Name", y="Total Receipt in million dollars")
# Sort by Total_Receipt and get top 50 candidates
receipt_data = data[order(-data$Total_Receipt),]
receipt_data = receipt_data[0:40,]
ggplot(receipt_data, aes(x=reorder(Cand_Name,Total_Receipt), y=Total_Receipt/1000000)) +
geom_point() +
coord_flip() +
theme(text = element_text(size=11, color="black"), axis.text.y=element_text(colour="black"),
axis.title=element_text(size=12)) +
labs(x="Candidate Name", y="Total Receipt in million dollars") +
ylim(-10000,)
# Sort by Total_Receipt and get top 50 candidates
receipt_data = data[order(-data$Total_Receipt),]
receipt_data = receipt_data[0:40,]
ggplot(receipt_data, aes(x=reorder(Cand_Name,Total_Receipt), y=Total_Receipt/1000000)) +
geom_point() +
coord_flip() +
theme(text = element_text(size=11, color="black"), axis.text.y=element_text(colour="black"),
axis.title=element_text(size=12)) +
labs(x="Candidate Name", y="Total Receipt in million dollars") +
ylim(-10000, 10)
# Sort by Total_Receipt and get top 50 candidates
receipt_data = data[order(-data$Total_Receipt),]
receipt_data = receipt_data[0:40,]
ggplot(receipt_data, aes(x=reorder(Cand_Name,Total_Receipt), y=Total_Receipt/1000000)) +
geom_point() +
coord_flip() +
theme(text = element_text(size=11, color="black"), axis.text.y=element_text(colour="black"),
axis.title=element_text(size=12)) +
labs(x="Candidate Name", y="Total Receipt in million dollars") +
ylim(-10, 10)
# ind_cont_states <- data %>%
#   group_by(Cand_State) %>%
#   summarize(Individual_Contribution = median(Individual_Contribution)) %>%
#   select(c(Cand_State, Individual_Contribution))
#
# head(ind_cont_states)
ind_cont_states <- data %>%
group_by(Cand_Office_St) %>%
summarize(Individual_Contribution = median(Individual_Contribution)) %>%
select(c(Cand_Office_St, Individual_Contribution))
head(ind_cont_states)
# Get map of united states consisting of longitude and latitude
state_map <- map_data("state", regions = ".")
# county_map
map_data <- left_join(ind_cont_states, state_map, by=c("Cand_Office_St" = "region"))
# map_data
# setdiff(county_map$subregions, ind_cont_states$Cand_City)
# setdiff(ind_cont_states$Cand_City, county_map$subregions)
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Individual_Contribution), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
ind_cont_states
# ind_cont_states <- data %>%
#   group_by(Cand_State) %>%
#   summarize(Individual_Contribution = median(Individual_Contribution)) %>%
#   select(c(Cand_State, Individual_Contribution))
#
# head(ind_cont_states)
ind_cont_states <- data %>%
group_by(Cand_Office_St) %>%
summarize(Total_Receipt = median(Total_Receipt)) %>%
select(c(Cand_Office_St, Total_Receipt))
ind_cont_states
# Get map of united states consisting of longitude and latitude
state_map <- map_data("state", regions = ".")
# county_map
map_data <- left_join(ind_cont_states, state_map, by=c("Cand_Office_St" = "region"))
# map_data
# setdiff(county_map$subregions, ind_cont_states$Cand_City)
# setdiff(ind_cont_states$Cand_City, county_map$subregions)
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_factor = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 170000 ~ "100000~150000",
Total_Receipt > 170000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 180000 ~ "100000~150000",
Total_Receipt > 180000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 190000 ~ "100000~150000",
Total_Receipt > 190000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 199000 ~ "100000~150000",
Total_Receipt > 199000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 140000 ~ "50000~100000",
Total_Receipt > 140000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 150000 ~ "50000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 190000 ~ "50000~150000",
Total_Receipt > 190000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 190000 ~ "50000~190000",
Total_Receipt > 190000 & Total_Receipt <= 200000 ~ "190000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color=qsec)
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
knitr::opts_chunk$set(echo = TRUE)
ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm")
library(ggplot2)
library(dplyr)
library(tidyverse)
library(gapminder)
library(reshape2)
library(maps)
library(ggmap)
library(lubridate)
data <- read.csv(file = './fec_2008-2022.csv')
# Get rid of variable X from data
data <- data %>%
select(-X)
# Column with only numerical and int data type
num_data <- data %>%
select(where(is.numeric)) %>%
select(-c(Cand_Office_Dist, Cand_Zip))
# Convert party affiliation to number -1 to 1 to use later for visualization
data$Cand_State <- tolower(state.name[match(data$Cand_State, state.abb)])
data$Cand_Office_St <- tolower(state.name[match(data$Cand_Office_St, state.abb)])
# data$Cand_State <- tolower(state.name[match(data$Cand_State, state.abb)])
data$Cand_City <- tolower(data$Cand_City)
data <- data %>% mutate(
Cand_Party_Affiliation_num = case_when(Cand_Party_Affiliation=="DEM" ~ 1,
Cand_Party_Affiliation=="REP" ~ -1,
Cand_Party_Affiliation!="REP" | Cand_Party_Affiliation!="DEM" ~ 0))
# Check data
# summary(data)
str(data)
data$Coverage_End_Date <- as.Date(data$Coverage_End_Date, "%d/%m/%Y")
data$coverage_year <- format(data$Coverage_End_Date, format="%Y")
data$coverage_month_day <- format(data$Coverage_End_Date, format="%m/%d")
data <- data %>%
filter(coverage_year > 2008 & coverage_year < 2021)
# data$coverage_month_day
df <- data %>%
group_by(coverage_year) %>%
summarize("median_cont" = median(Total_Disbursement)) %>%
select(coverage_year, median_cont)
df
ggplot(df, aes(x=as.numeric(coverage_year), y=median_cont)) +
geom_point() +
geom_line(color = "#0072B2", size=0.75) +
labs(x="Coverage End Year", y="Median Contribution")
# scale_x_date(breaks="1 month", date_labels="%Y%m") +
# theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# theme(text = element_text(size=13, color="black"),axis.text.y=element_text(colour="black"))
ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm")
# ind_cont_states <- data %>%
#   group_by(Cand_State) %>%
#   summarize(Individual_Contribution = median(Individual_Contribution)) %>%
#   select(c(Cand_State, Individual_Contribution))
#
# head(ind_cont_states)
ind_cont_states <- data %>%
group_by(Cand_Office_St) %>%
summarize(Total_Receipt = median(Total_Receipt)) %>%
select(c(Cand_Office_St, Total_Receipt))
ind_cont_states
# Get map of united states consisting of longitude and latitude
state_map <- map_data("state", regions = ".")
# county_map
map_data <- left_join(ind_cont_states, state_map, by=c("Cand_Office_St" = "region"))
# map_data
# setdiff(county_map$subregions, ind_cont_states$Cand_City)
# setdiff(ind_cont_states$Cand_City, county_map$subregions)
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm", se=FALSE)
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 190000 ~ "50000~190000",
Total_Receipt > 190000 & Total_Receipt <= 200000 ~ "190000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
#   scale_fill_gradient2(limit = c(-1,1),low="blue", mid="white", high="red",
#                        na.value = "grey90", name="Party Ratio") +
# theme(panel.background = element_rect(fill = 'grey70', colour = 'white'))
ggplot(data, aes(x=Total_Contribution, y=Total_Disbursement)) +
geom_point() +
geom_smooth(method="lm") +
labs(x="Total Contribution", y="Total Disbursement")
# ind_cont_states <- data %>%
#   group_by(Cand_State) %>%
#   summarize(Individual_Contribution = median(Individual_Contribution)) %>%
#   select(c(Cand_State, Individual_Contribution))
#
# head(ind_cont_states)
ind_cont_states <- data %>%
group_by(Cand_Office_St) %>%
summarize(Total_Receipt = median(Total_Receipt)) %>%
select(c(Cand_Office_St, Total_Receipt))
ind_cont_states
# Get map of united states consisting of longitude and latitude
state_map <- map_data("state", regions = ".")
# county_map
map_data <- left_join(ind_cont_states, state_map, by=c("Cand_Office_St" = "region"))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt), color = "white")
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white")
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_colour_manual(values = c("red", "blue", "green"))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_colour_manual(values = c("red", "red", "green"))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_discrete_manual(values = c("red", "blue", "green"))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_manual(values = c("red", "blue", "green"))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="Dark2")
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="GnBu")
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="Blues")
# Get map of united states consisting of longitude and latitude
state_map <- map_data("state", regions = ".")
# county_map
map_data <- left_join(ind_cont_states, state_map, by=c("Cand_Office_St" = "region"))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
map_data <- map_data %>%
mutate(Total_Receipt_F = factor(Total_Receipt_F, levels=c("50000~100000", "100000~150000", "150000~200000")))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="Blues")
# Get map of united states consisting of longitude and latitude
state_map <- map_data("state", regions = ".")
# county_map
map_data <- left_join(ind_cont_states, state_map, by=c("Cand_Office_St" = "region"))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
map_data <- map_data %>%
mutate(Total_Receipt_F = factor(Total_Receipt_F, levels=c("50000~100000", "100000~150000","150000~200000")))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="Blues")
# Get map of united states consisting of longitude and latitude
state_map <- map_data("state", regions = ".")
# county_map
map_data <- left_join(ind_cont_states, state_map, by=c("Cand_Office_St" = "region"))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
map_data <- map_data %>%
mutate(Total_Receipt_F = factor(Total_Receipt_F, levels=c("0~50000", "50000~100000", "100000~150000","150000~200000")))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="Blues")
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="Blues")
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 190000 ~ "50000~190000",
Total_Receipt > 190000 & Total_Receipt <= 200000 ~ "190000~200000"
))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="Blues")
# Get map of united states consisting of longitude and latitude
state_map <- map_data("state", regions = ".")
# county_map
map_data <- left_join(ind_cont_states, state_map, by=c("Cand_Office_St" = "region"))
map_data <- map_data %>%
mutate(Total_Receipt_F = case_when(
Total_Receipt <= 50000 ~ "0~50000",
Total_Receipt > 50000 & Total_Receipt <= 100000 ~ "50000~100000",
Total_Receipt > 100000 & Total_Receipt <= 150000 ~ "100000~150000",
Total_Receipt > 150000 & Total_Receipt <= 200000 ~ "150000~200000"
))
map_data <- map_data %>%
mutate(Total_Receipt_F = factor(Total_Receipt_F, levels=c("0~50000", "50000~100000", "100000~150000","150000~200000")))
ggplot(map_data, aes(long, lat, group = group)) +
geom_polygon(aes(fill = Total_Receipt_F), color = "white") +
scale_fill_brewer(palette="Blues")
plot(cars)
## aaa
plot(cars)
